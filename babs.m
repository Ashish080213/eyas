1;
pkg load control;
a = -0.0060949;
A = [0 1 0 0;0 -0.10572 1892.704 0; 0 0 0 1; 0 a 193.8901 0];
A_d = [1 0.009995 0.09475 0.0003157; 0 0.9989 18.98 0.09475; 0 -3.051e-07 1.01 0.01003; 0 -6.111e-05 1.945 1.01];
B = [0; 0.8997; 0; 0.05186];
B_d = [4.501e-05;0.009009;2.596e-06;0.00052];
C = [1 0 0 0; 0 0 1 0];
D = [0;0]
Ts = 1/100;
sys_s = ss(A,B,C,D);
sys_d = c2d(sys_s,Ts)
Q = [1000 0 0 0;0 100000/500 0 0; 0 0 1550000 0;0 0 0 15500000];
R = 0.0001;
K = dlqr(A,B,Q,R);
y0 = [10;0;3.14;0];
y = [2.5;0;3.14;0];
cost = 0;
for i = 1:100
   U = -K*(y-y0);
   cost = cost +  (y'*Q*y +U'*R*U);
   y_new = (A_d-B_d*K)*y;
   %y_new = A*y + B*U
   y = y_new;
   %U = -K*(y-y0);
endfor
abs(eigs(A_d))